<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Enterprise Finance Intelligence</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #05070A; color: #E2E8F0; }
        .glass-panel { background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(255, 255, 255, 0.05); backdrop-filter: blur(12px); border-radius: 28px; }
        .chart-container { position: relative; height: 280px; width: 100%; }
        .gradient-border { border: 1px solid; border-image: linear-gradient(to bottom, rgba(59,130,246,0.5), rgba(59,130,246,0)) 1; }
        .tab-active { color: #3B82F6; border-bottom: 2px solid #3B82F6; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body x-data="financeCore()" x-init="initGlobal()">

    <nav class="fixed top-0 w-full z-50 px-6 py-5 flex justify-between items-center bg-[#05070A]/80 backdrop-blur-xl border-b border-white/5">
        <div class="flex items-center gap-2">
            <div class="w-3 h-3 bg-blue-500 rounded-full animate-pulse"></div>
            <h1 class="text-lg font-extrabold tracking-tighter uppercase">Analytix<span class="text-blue-500">Pro</span></h1>
        </div>
        <div @click="view = 'admin'" class="w-10 h-10 rounded-2xl bg-white/5 border border-white/10 flex items-center justify-center cursor-pointer active:scale-90 transition">
            <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M4 6h16M4 12h16m-7 6h7"></path></svg>
        </div>
    </nav>

    <main x-show="view === 'home'" class="pt-28 pb-32 px-5 max-w-xl mx-auto space-y-6">
        
        <div class="glass-panel p-6 space-y-4">
            <div class="flex justify-between items-start">
                <div>
                    <p class="text-xs font-bold text-gray-500 uppercase">Umumiy Portfel</p>
                    <h2 class="text-4xl font-black mt-1">92.4<span class="text-blue-500 text-lg">%</span></h2>
                </div>
                <span class="bg-green-500/10 text-green-500 text-[10px] font-black px-2 py-1 rounded-full">+4.2%</span>
            </div>
            <div class="chart-container">
                <canvas id="mainAreaChart"></canvas>
            </div>
        </div>

        <div class="rounded-[2rem] overflow-hidden relative h-40 group border border-white/5">
            <img :src="ads.image" class="w-full h-full object-cover opacity-60">
            <div class="absolute inset-0 bg-gradient-to-t from-[#05070A] p-6 flex flex-col justify-end">
                <p class="text-[10px] font-bold text-blue-400 uppercase tracking-widest">Premium Taklif</p>
                <h3 class="text-lg font-bold leading-tight">Biznesingizni yangi bosqichga <br> olib chiqing</h3>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
            <template x-for="m in modules">
                <div @click="openModule(m)" class="glass-panel p-5 cursor-pointer active:scale-95 transition-all">
                    <div :class="m.color" class="w-10 h-10 rounded-xl flex items-center justify-center text-xl mb-4" x-text="m.icon"></div>
                    <h4 class="font-bold text-sm" x-text="m.name"></h4>
                    <p class="text-[10px] text-gray-500 mt-1" x-text="m.desc"></p>
                </div>
            </template>
        </div>

        <div class="py-10 text-center opacity-10">
            <input type="text" x-model="secretCode" @input="checkSecret" placeholder="..." class="bg-transparent text-center outline-none w-full">
        </div>
    </main>

    <template x-for="m in modules">
        <div x-show="view === m.id" class="fixed inset-0 z-[60] bg-[#05070A] overflow-y-auto">
            <div class="p-6 flex justify-between items-center border-b border-white/5 sticky top-0 bg-[#05070A]/90 backdrop-blur">
                <button @click="view = 'home'" class="text-blue-500 font-bold">‚Üê Yopish</button>
                <span class="text-[10px] font-black uppercase text-gray-500" x-text="m.name"></span>
            </div>

            <div class="p-6 max-w-xl mx-auto space-y-6">
                <div class="glass-panel p-6">
                    <div class="chart-container">
                        <canvas :id="'chart-' + m.id"></canvas>
                    </div>
                </div>

                <div class="glass-panel p-8 space-y-6">
                    <template x-for="f in m.fields">
                        <div class="space-y-2">
                            <label class="text-[10px] font-bold text-gray-500 uppercase tracking-widest" x-text="f.label"></label>
                            <input type="number" x-model="f.value" @input="calculate(m.id)"
                                   class="w-full bg-white/5 border border-white/10 p-5 rounded-2xl text-2xl font-black focus:border-blue-500 transition-all outline-none">
                        </div>
                    </template>
                </div>

                <div class="bg-blue-600 rounded-[2.5rem] p-8 shadow-2xl shadow-blue-900/40">
                    <p class="text-white/60 text-xs font-bold uppercase" x-text="m.resLabel"></p>
                    <h3 class="text-4xl font-black mt-2" x-text="format(m.result, m.unit)"></h3>
                    <div class="mt-4 p-4 bg-black/20 rounded-2xl">
                        <p class="text-xs leading-relaxed opacity-90" x-text="m.insight"></p>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <div x-show="showAdmin" class="fixed inset-0 z-[100] bg-[#05070A] overflow-y-auto">
        <div class="p-8">
            <div class="flex justify-between items-center mb-10">
                <h2 class="text-3xl font-black tracking-tighter">BOSHQARUV <span class="text-blue-500">MARKAZI</span></h2>
                <button @click="showAdmin = false" class="bg-white/5 p-3 rounded-full">‚úï</button>
            </div>

            <div class="grid grid-cols-2 gap-4 mb-8">
                <div class="glass-panel p-6">
                    <p class="text-[10px] font-bold text-gray-500 uppercase">Tashriflar</p>
                    <p class="text-3xl font-black text-blue-500">2.4k</p>
                </div>
                <div class="glass-panel p-6">
                    <p class="text-[10px] font-bold text-gray-500 uppercase">Reklama CTR</p>
                    <p class="text-3xl font-black text-green-500">18%</p>
                </div>
            </div>

            <div class="glass-panel p-8 space-y-6">
                <h3 class="font-bold">Media Boshqaruvi</h3>
                <input type="text" x-model="ads.image" class="w-full bg-white/5 p-4 rounded-xl border border-white/10 outline-none" placeholder="Rasm/Video URL">
                <button @click="showAdmin = false" class="w-full py-5 bg-blue-600 rounded-2xl font-black uppercase tracking-widest shadow-xl">Yangilash</button>
            </div>
        </div>
    </div>

    <script>
        function financeCore() {
            return {
                view: 'home',
                showAdmin: false,
                secretCode: '',
                ads: { image: 'https://images.unsplash.com/photo-1551288049-bebda4e38f71?q=80&w=1470&auto=format&fit=crop' },
                
                modules: [
                    { id: 'pnl', name: 'P&L (Foyda/Zarar)', desc: 'Haqiqiy rentabellik tahlili', icon: 'üìä', color: 'bg-blue-500/20 text-blue-500', resLabel: 'Sof Operatsion Foyda', result: 0, unit: 'sum', insight: 'P&L hisoboti sizning qog\'ozdagi foydangizni ko\'rsatadi. Bu kassa qoldig\'i bilan mos kelmasligi mumkin.', fields: [{label: 'Yalpi tushum', value: 0}, {label: 'Operatsion xarajatlar', value: 0}] },
                    { id: 'cashflow', name: 'Cash Flow Bashorati', desc: 'Pul qachon tugashini ko\'ring', icon: 'üìâ', color: 'bg-red-500/20 text-red-500', resLabel: 'Bashorat qilingan qoldiq', result: 0, unit: 'sum', insight: 'Kassoviy razrivni oldini olish uchun kelgusi to\'lovlarni jadvalga muvofiq kiritib boring.', fields: [{label: 'Kutilayotgan Kirim', value: 0}, {label: 'Zaruriy Chiqim', value: 0}] },
                    { id: 'unit', name: 'Unit-Ekonomika', desc: '1 ta sotuvdan sof foyda', icon: 'üì¶', color: 'bg-green-500/20 text-green-500', resLabel: 'Marginal foyda', result: 0, unit: 'sum', insight: 'Agar bir dona mahsulotdan foyda minus bo\'lsa, savdo hajmini oshirish faqat zarar keltiradi.', fields: [{label: 'Sotish Narxi', value: 0}, {label: 'Tannarx + Reklama (CAC)', value: 0}] },
                    { id: 'roi', name: 'ROI / Investitsiya', desc: 'Sarmoyani oqlash muddati', icon: 'üöÄ', color: 'bg-purple-500/20 text-purple-500', resLabel: 'Qaytish darajasi', result: 0, unit: 'percent', insight: 'Investitsiya o\'zini oqlash darajasi yillik 25% dan yuqori bo\'lishi ideal hisoblanadi.', fields: [{label: 'Kiritilgan kapital', value: 0}, {label: 'Yillik sof foyda', value: 0}] }
                ],

                checkSecret() {
                    if(this.secretCode === 'admin paneli ochilsin!') {
                        this.showAdmin = true;
                        this.secretCode = '';
                    }
                },

                openModule(m) {
                    this.view = m.id;
                    this.$nextTick(() => this.initChart(m.id));
                },

                calculate(id) {
                    let m = this.modules.find(x => x.id === id);
                    let v1 = parseFloat(m.fields[0].value) || 0;
                    let v2 = parseFloat(m.fields[1].value) || 0;

                    if(id === 'pnl' || id === 'cashflow' || id === 'unit') m.result = v1 - v2;
                    if(id === 'roi') m.result = v1 > 0 ? (v2 / v1) * 100 : 0;

                    this.updateChart(id, v1, v2);
                },

                format(v, unit) {
                    let val = new Intl.NumberFormat('uz-UZ').format(v);
                    return unit === 'sum' ? val + " so'm" : val + " %";
                },

                charts: {},
                initGlobal() {
                    setTimeout(() => {
                        const ctx = document.getElementById('mainAreaChart');
                        new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: ['Dushanba', 'Seshanba', 'Chorshanba', 'Payshanba', 'Juma'],
                                datasets: [{
                                    data: [40, 65, 52, 88, 70],
                                    borderColor: '#3B82F6',
                                    borderWidth: 4,
                                    fill: true,
                                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                    tension: 0.4,
                                    pointRadius: 0
                                }]
                            },
                            options: { plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { display: false } }, maintainAspectRatio: false }
                        });
                    }, 100);
                },

                initChart(id) {
                    const ctx = document.getElementById('chart-' + id);
                    if(!ctx) return;
                    if(this.charts[id]) this.charts[id].destroy();

                    this.charts[id] = new Chart(ctx, {
                        type: id === 'pnl' ? 'bar' : 'line',
                        data: {
                            labels: ['Prognoz', 'Haqiqat'],
                            datasets: [{
                                label: 'Moliyaviy ko\'rsatkich',
                                data: [0, 0],
                                backgroundColor: id === 'cashflow' ? 'rgba(239, 68, 68, 0.2)' : 'rgba(59, 130, 246, 0.2)',
                                borderColor: id === 'cashflow' ? '#EF4444' : '#3B82F6',
                                borderWidth: 3,
                                fill: true,
                                tension: 0.3
                            }]
                        },
                        options: { 
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { legend: { display: false } },
                            scales: { 
                                y: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#64748B', font: { size: 10 } } },
                                x: { grid: { display: false }, ticks: { color: '#64748B', font: { size: 10 } } }
                            }
                        }
                    });
                },

                updateChart(id, v1, v2) {
                    if(this.charts[id]) {
                        this.charts[id].data.datasets[0].data = [v1, v2];
                        this.charts[id].update('none');
                    }
                }
            }
        }
    </script>
</body>
</html>
